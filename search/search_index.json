{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"base_host/","title":"Base Host configuration","text":""},{"location":"base_host/#hardware","title":"Hardware","text":"<p>Hardware is being repurposed from the old Kubernetes worker nodes.</p> Device Count OS disk Data disk(s) RAM OS Purpose HP Prodesk 600 G3 DM 1 128 GB SATA 16 GB NixOS 25.11"},{"location":"base_host/#storage","title":"Storage","text":""},{"location":"base_host/#local-storage","title":"Local Storage","text":"<p>All local storage should be provided under <code>/srv</code></p> <ul> <li><code>/srv/data</code> - Local SSD storage, mapped to the NVMe/Data Disk</li> <li><code>/srv/data/&lt;application&gt;</code> - Per application folder<ul> <li><code>/srv/data/&lt;application&gt;/&lt;mount&gt;</code> - Per application mount point, e.g. <code>/srv/data/sonarr/config</code></li> </ul> </li> <li><code>/srv/cluster</code> - Clustered storage, e.g. CephFS, GlusterFS, etc. Not mounted directly</li> </ul>"},{"location":"base_host/#remote-storage","title":"Remote Storage","text":"<p>Mounts for remote storage should be placed under <code>/mnt</code>, ideally using NFSv4 or whatever cluster-native mounting protocol is available.</p> <ul> <li><code>/mnt/&lt;hostname&gt;/&lt;share&gt;</code> - Mounted network storage and clustered storage, e.g. <code>/mnt/nas-03/media</code></li> </ul>"},{"location":"base_host/#backups","title":"Backups","text":"<p>Backups are managed by <code>borgmatic</code> and stored on a remote server. Only files under <code>/srv/data</code> should be backed up.</p>"},{"location":"base_host/#monitoring","title":"Monitoring","text":"<ul> <li>Prometheus node exporter for host metrics</li> </ul>"},{"location":"macos/","title":"Nix on macOS","text":"<ul> <li>Install Deterministic Nix from https://nix.deterministic.systems/ and follow the instructions to set it up.</li> <li>Run <code>nix profile add github:/nix-community/nixd</code> to install <code>nixd</code> LSP server.</li> <li>Run <code>nix profile add github:oxalica/nil</code> to install <code>nil</code> LSP client.</li> <li>Restart your terminal and editor.</li> </ul>"},{"location":"raspberry_pi/","title":"Raspberry Pi Systems","text":""},{"location":"raspberry_pi/#requirements","title":"Requirements","text":"<ul> <li>A system capable of emulating <code>aarch64-linux</code></li> <li>Nix</li> <li>A <code>nixosConfiguration</code> that imports <code>\"${nixpkgs}/nixos/modules/installer/sd-card/sd-image-aarch64.nix\"</code> from Nixpkgs. (see flake.nix and ns1 host)</li> </ul>"},{"location":"raspberry_pi/#pre-setup","title":"Pre-setup","text":"<ul> <li>A build system is required (suggested a NixOS system) with configuration for emulation:</li> </ul> <pre><code>  # Allows for cross compling for Pis\n  boot.binfmt.emulatedSystems = [ \"aarch64-linux\" ];\n  nix.settings.extra-platforms = [\n    \"aarch64-linux\"\n    \"arm-linux\"\n  ];\n</code></pre>"},{"location":"raspberry_pi/#building","title":"Building","text":"<p>Run <code>nix-build</code> targetting the configuration, in this case, the Flake <code>nixosConfigurations</code> <code>sdImage</code></p> <pre><code>nikdoof@svc-02:~/ &gt; nix build --refresh github:nikdoof/nixos-homeprod#nixosConfigurations.ns-01.config.system.build.sdImage\nnikdoof@svc-02:~/ &gt; ls\nresult\nnikdoof@svc-02:~/ &gt; ls result\nnix-support  sd-image\nnikdoof@svc-02:~/ &gt; ls result/sd-image\nnixos-image-sd-card-25.11.20260207.23d72da-aarch64-linux.img.zst\nnikdoof@svc-02:~/ &gt;\n</code></pre> <p>This results in a standard <code>img</code> file that can be wrote to a SD card.</p>"}]}