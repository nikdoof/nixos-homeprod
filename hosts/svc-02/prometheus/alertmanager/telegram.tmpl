{{ define "doofnet.alert" }}

{{ if eq .Status "resolved" }}âœ…{{ else }}{{ if eq .Labels.severity "critical" }}ğŸš¨{{- else -}}{{- if eq .Labels.severity "warning" }}âš ï¸{{- else -}}ğŸ›ï¸{{ end }}{{ end }}{{ end }} <b>{{ .Labels.alertname }}</b> {{ if .Annotations.summary }} - {{ .Annotations.summary }}{{ end }}

<i>{{ .Annotations.description }}</i>
{{- if .Labels.pod }}

ğŸ³ Pod: <code>{{ .Labels.namespace }}/{{ .Labels.pod  }}</code>
{{- end }}
{{- if .Annotations.runbook_url }}

ğŸ“– <a href="{{ .Annotations.runbook_url }}">Runbook</a>
{{- end }}
{{- end }}

{{ define "doofnet.alert_list" }}
{{ range . -}}{{ template "doofnet.alert" . }}{{ end }}
{{ end }}

{{ define "telegram.doofnet.message" }}
{{ template "doofnet.alert_list" .Alerts }}
ğŸ›  <a href="https://grafana.svc.doofnet.uk">Grafana</a> ğŸ’Š <a href="https://alertmanager.svc.doofnet.uk">Alertmanager</a>
{{ end }}
